<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Examples &mdash; cuFFTDx 1.1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/cufftdx_override.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Release Notes" href="release_notes.html" />
    <link rel="prev" title="Execution Methods" href="api/methods.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" > 
            <a href="index.html" class="icon icon-home"> cuFFTDx
          </a>
              <div class="version">
                1.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

  <style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search, .wy-nav-top {
      background: #76b900;
    }

    .wy-side-nav-search a:link, .wy-nav-top a:link {
      color: #fff;
    }
    .wy-side-nav-search a:visited, .wy-nav-top a:visited {
      color: #fff;
    }
    .wy-side-nav-search a:hover, .wy-nav-top a:hover {
      color: #fff;
    }

    .wy-menu-vertical a:link, .wy-menu-vertical a:visited {
      color: #d9d9d9
    }

    .wy-menu-vertical a:active {
      background-color: #76b900
    }

    .wy-side-nav-search>div.version {
      color: rgba(0, 0, 0, 0.3)
    }

    /* override table width restrictions */
    .wy-table-responsive table td, .wy-table-responsive table th {
        white-space: normal;
    }

    .wy-table-responsive {
        margin-bottom: 24px;
        max-width: 100%;
        overflow: visible;
    }
  </style>
  
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">Documentation home</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User guide:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="requirements_func.html">Requirements and Functionality</a><ul>
<li class="toctree-l2"><a class="reference internal" href="requirements_func.html#requirements">Requirements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="requirements_func.html#supported-compilers">Supported Compilers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="requirements_func.html#supported-functionality">Supported Functionality</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Quick Installation Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#cufftdx-in-your-project">cuFFTDx In Your Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#cufftdx-in-your-cmake-project">cuFFTDx In Your CMake Project</a><ul>
<li class="toctree-l3"><a class="reference internal" href="installation.html#defined-variables">Defined Variables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="introduction1.html">First FFT Using cuFFTDx</a><ul>
<li class="toctree-l2"><a class="reference internal" href="introduction1.html#defining-basic-fft">Defining Basic FFT</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction1.html#executing-fft">Executing FFT</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction1.html#launching-fft-kernel">Launching FFT Kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction1.html#compilation">Compilation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="introduction2.html">Your Next Custom FFT Kernels</a><ul>
<li class="toctree-l2"><a class="reference internal" href="introduction2.html#using-optimal-parameters">Using Optimal parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction2.html#extra-shared-memory">Extra Shared Memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction2.html#what-happens-under-the-hood">What happens under the hood</a><ul>
<li class="toctree-l3"><a class="reference internal" href="introduction2.html#why">Why?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="performance.html">Achieving High Performance</a><ul>
<li class="toctree-l2"><a class="reference internal" href="performance.html#general-advice">General Advice</a></li>
<li class="toctree-l2"><a class="reference internal" href="performance.html#memory-management">Memory Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="performance.html#kernel-fusion">Kernel Fusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="performance.html#advanced">Advanced</a></li>
<li class="toctree-l2"><a class="reference internal" href="performance.html#further-reading">Further Reading</a><ul>
<li class="toctree-l3"><a class="reference internal" href="performance.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/index.html">cuFFTDx API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/operators.html">Operators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/operators.html#description-operators">Description Operators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/operators.html#size-operator">Size Operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/operators.html#direction-operator">Direction Operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/operators.html#type-operator">Type Operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/operators.html#precision-operator">Precision Operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/operators.html#sm-operator">SM Operator</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/operators.html#execution-operators">Execution Operators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/operators.html#thread-operator">Thread Operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/operators.html#block-operator">Block Operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/operators.html#block-configuration-operators">Block Configuration Operators</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/traits.html">Traits</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/traits.html#description-traits">Description Traits</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/traits.html#size-trait">Size Trait</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/traits.html#type-trait">Type Trait</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/traits.html#direction-trait">Direction Trait</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/traits.html#precision-trait">Precision Trait</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/traits.html#is-fft-trait">Is FFT? Trait</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/traits.html#is-fft-execution-trait">Is FFT Execution? Trait</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/traits.html#is-fft-complete-trait">Is FFT-complete? Trait</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/traits.html#is-fft-complete-execution-trait">Is FFT-complete Execution? Trait</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/traits.html#execution-traits">Execution Traits</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/traits.html#thread-traits">Thread Traits</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/traits.html#block-traits">Block Traits</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/traits.html#other-traits">Other Traits</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/traits.html#cufftdx-is-supported">cufftdx::is_supported</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/methods.html">Execution Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/methods.html#thread-execute-method">Thread Execute Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/methods.html#block-execute-method">Block Execute Method</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/methods.html#value-format">Value Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/methods.html#input-output-data-format">Input/Output Data Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/methods.html#shared-memory-usage">Shared Memory Usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/methods.html#make-workspace-function">Make Workspace Function</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction-examples">Introduction Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="#simple-fft-examples">Simple FFT Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#simple-fft-thread-examples">simple_fft_thread* Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="#simple-fft-block-examples">simple_fft_block* Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="#extra-simple-fft-block-examples">Extra simple_fft_block(*) Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#nvrtc-examples">NVRTC Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fft-performance">FFT Performance</a></li>
<li class="toctree-l2"><a class="reference internal" href="#convolution-examples">Convolution Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="#input-output-helper-functions">Input/Output Helper Functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="release_notes.html#id1">1.1.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="release_notes.html#new-features">New Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="release_notes.html#known-issues">Known Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="release_notes.html#id2">1.0.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="release_notes.html#id3">New Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="release_notes.html#resolved-issues">Resolved Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="release_notes.html#id4">0.3.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="release_notes.html#id5">Known Issues</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="license.html">Software License Agreement</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">cuFFTDx</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">Examples</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="examples">
<span id="examples-label"></span><h1>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">¶</a></h1>
<p>The cuFFTDx library provides multiple thread and block-level FFT samples covering all supported precisions
and types, as well as a few special examples that highlight performance benefits of cuFFTDx.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 17%" />
<col style="width: 19%" />
<col style="width: 51%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" colspan="4"><p>Examples</p></th>
</tr>
<tr class="row-even"><th class="head" colspan="2"><p>Group</p></th>
<th class="head" rowspan="2"><p>Example</p></th>
<th class="head" rowspan="2"><p>Description</p></th>
</tr>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>Subgroup</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td colspan="2"><p>Introduction Examples</p></td>
<td><p>introduction_example</p></td>
<td><p>cuFFTDx API introduction</p></td>
</tr>
<tr class="row-odd"><td rowspan="13"><p>Simple FFT Examples</p></td>
<td rowspan="3"><p>Thread FFT Examples</p></td>
<td><p>simple_fft_thread</p></td>
<td><p>Complex-to-complex thread FFT</p></td>
</tr>
<tr class="row-even"><td><p>simple_fft_thread_fp16</p></td>
<td><p>Complex-to-complex thread FFT half-precision</p></td>
</tr>
<tr class="row-odd"><td colspan="2"></td>
</tr>
<tr class="row-even"><td rowspan="7"><p>Block FFT Examples</p></td>
<td><p>simple_fft_block</p></td>
<td><p>Complex-to-complex block FFT</p></td>
</tr>
<tr class="row-odd"><td><p>simple_fft_block_r2c</p></td>
<td><p>Real-to-complex block FFT</p></td>
</tr>
<tr class="row-even"><td><p>simple_fft_block_c2r</p></td>
<td><p>Complex-to-real block FFT</p></td>
</tr>
<tr class="row-odd"><td><p>simple_fft_block_half2</p></td>
<td><p>Complex-to-complex block FFT with <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">__half2</span><span class="w"></span></code> as data type</p></td>
</tr>
<tr class="row-even"><td><p>simple_fft_block_fp16</p></td>
<td><p>Complex-to-complex block FFT half-precision</p></td>
</tr>
<tr class="row-odd"><td><p>simple_fft_block_r2c_fp16</p></td>
<td><p>Real-to-complex block FFT half-precision</p></td>
</tr>
<tr class="row-even"><td><p>simple_fft_block_c2r_fp16</p></td>
<td><p>Complex-to-real block FFT half-precision</p></td>
</tr>
<tr class="row-odd"><td rowspan="3"><p>Extra Block FFT Examples</p></td>
<td><p>simple_fft_block_shared</p></td>
<td><p>Complex-to-complex block FFT shared-memory API</p></td>
</tr>
<tr class="row-even"><td><p>simple_fft_block_std_complex</p></td>
<td><p>Complex-to-complex block FFT with <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">cuda</span><span class="o">::</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="w"></span></code> as data type</p></td>
</tr>
<tr class="row-odd"><td><p>simple_fft_block_cub_io</p></td>
<td><p>Complex-to-complex block FFT with <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">CUB</span><span class="w"></span></code> used for loading/storing data</p></td>
</tr>
<tr class="row-even"><td colspan="2" rowspan="3"><p>NVRTC Examples</p></td>
<td><p>nvrtc_fft_thread</p></td>
<td><p>Complex-to-complex thread FFT</p></td>
</tr>
<tr class="row-odd"><td><p>nvrtc_fft_block</p></td>
<td><p>Complex-to-complex block FFT</p></td>
</tr>
<tr class="row-even"><td colspan="2"></td>
</tr>
<tr class="row-odd"><td colspan="2" rowspan="3"><p>FFT Performance</p></td>
<td><p>block_fft_performance</p></td>
<td><p>Benchmark for C2C block FFT</p></td>
</tr>
<tr class="row-even"><td><p>block_fft_performance_many</p></td>
<td><p>Benchmark for C2C/R2C/C2R block FFT</p></td>
</tr>
<tr class="row-odd"><td colspan="2"></td>
</tr>
<tr class="row-even"><td colspan="2" rowspan="3"><p>Convolution Example</p></td>
<td><p>convolution</p></td>
<td><p>Simplified FFT convolution</p></td>
</tr>
<tr class="row-odd"><td><p>convolution_r2c_c2r</p></td>
<td><p>Simplified R2C-C2R FFT convolution</p></td>
</tr>
<tr class="row-even"><td><p>convolution_performance</p></td>
<td><p>Benchmark for FFT convolution using cuFFTDx and cuFFT</p></td>
</tr>
</tbody>
</table>
<div class="section" id="introduction-examples">
<span id="examples-introduction-examples-label"></span><h2>Introduction Examples<a class="headerlink" href="#introduction-examples" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">introduction_example</span><span class="w"></span></code></p></li>
</ul>
<p>Examples used in the documentation to explain basics of the cuFFTDx library and its API. <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">introduction_example</span><span class="w"></span></code> is used
in the introductory guide to cuFFTDx API: <a class="reference internal" href="introduction1.html#intro1-label"><span class="std std-ref">First FFT Using cuFFTDx</span></a>.</p>
</div>
<div class="section" id="simple-fft-examples">
<h2>Simple FFT Examples<a class="headerlink" href="#simple-fft-examples" title="Permalink to this heading">¶</a></h2>
<div class="section" id="simple-fft-thread-examples">
<h3>simple_fft_thread* Examples<a class="headerlink" href="#simple-fft-thread-examples" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">simple_fft_thread</span><span class="w"></span></code></p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">simple_fft_thread_fp16</span><span class="w"></span></code></p></li>
</ul>
<p>In each of the examples listed above a one-dimensional complex-to-complex FFT routine is performed by a single CUDA thread. In both
samples multiple threads are run, and each thread calculates an FFT. The input data is generated on the host, copied to a device
buffer, and then the final results are copied back to the host.</p>
<p>The <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">simple_fft_thread_fp16</span><span class="w"></span></code> example showcases the support for half-precision (fp16) in cuFFTDx. Please note that for half-precision
cuFFTDx processes values in implicit batches of two FFTs, ie. each thread processes two FFTs. See also
<a class="reference internal" href="api/methods.html#execution-methods-half-implicit-batching-label"><span class="std std-ref">Half-Precision Implicit Batching</span></a> section.</p>
</div>
<div class="section" id="simple-fft-block-examples">
<h3>simple_fft_block* Examples<a class="headerlink" href="#simple-fft-block-examples" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">simple_fft_block</span><span class="w"></span></code></p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">simple_fft_block_r2c</span><span class="w"></span></code></p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">simple_fft_block_c2r</span><span class="w"></span></code></p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">simple_fft_block_half2</span><span class="w"></span></code></p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">simple_fft_block_fp16</span><span class="w"></span></code></p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">simple_fft_block_r2c_fp16</span><span class="w"></span></code></p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">simple_fft_block_c2r_fp16</span><span class="w"></span></code></p></li>
</ul>
<p>In each of the examples listed above a one-dimensional complex-to-complex, real-to-complex or complex-to-real FFT is performed in a CUDA block.
The examples show how to create a complete FFT description, and then set the correct block dimensions and the necessary amount of shared memory.
In the kernels the required array (<code class="code highlight cpp docutils literal highlight-cpp"><span class="n">thread_data</span><span class="w"></span></code>) in per-thread registers is allocated, the input data is copied into them, the FFT
is executed, and results are transferred back to global memory. All samples use input/output functions from <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">block_io</span><span class="p">.</span><span class="n">hpp</span><span class="w"></span></code>. The input data
is generated on the host, copied to a device buffer, and then the final results are copied back to the host.</p>
<p>The <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">simple_fft_block_</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="n">_fp16</span><span class="w"></span></code> examples showcase the support for half-precision (fp16) in cuFFTDx. Please note that in half-precision
processes values in implicit batches of two FFTs, ie. each thread processes two FFTs. See also
<a class="reference internal" href="api/methods.html#execution-methods-half-implicit-batching-label"><span class="std std-ref">Half-Precision Implicit Batching</span></a> section.</p>
<p>The <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">simple_fft_block_half2</span><span class="w"></span></code> example differs from <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">simple_fft_block_fp16</span><span class="w"></span></code> as it uses <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">__half2</span><span class="w"></span></code> type instead of <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">cufftdx</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="n">__half2</span><span class="o">&gt;</span><span class="w"></span></code>
for half-precision complex values, which means data is not implicitly batched on the type level. For this reason this examples uses
a special load function (and accordingly store function) that loads and rearranges values from input buffer into <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">cufftdx</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="n">__half2</span><span class="o">&gt;</span><span class="w"></span></code> values
introducing implicit batching. See also
<a class="reference internal" href="api/methods.html#execution-methods-half-implicit-batching-label"><span class="std std-ref">Half-Precision Implicit Batching</span></a> section.</p>
</div>
<div class="section" id="extra-simple-fft-block-examples">
<h3>Extra simple_fft_block(*) Examples<a class="headerlink" href="#extra-simple-fft-block-examples" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">simple_fft_block_shared</span><span class="w"></span></code></p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">simple_fft_block_std_complex</span><span class="w"></span></code></p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">simple_fft_block_cub_io</span><span class="w"></span></code></p></li>
</ul>
<p>The <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">simple_fft_block_shared</span><span class="w"></span></code> is different
from other <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">simple_fft_block_</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"></span></code> examples because it uses the shared memory cuFFTDx API, see methods #3 and #4 in section
<a class="reference internal" href="api/methods.html#block-execute-method-label"><span class="std std-ref">Block Execute Method</span></a>.</p>
<p>The <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">simple_fft_block_std_complex</span><span class="w"></span></code> sample shows that <a class="reference external" href="https://nvidia.github.io/libcudacxx/standard_api/numerics_library/complex.html">cuda::std::complex</a>
type can be used as the complex value type for data passed to cuFFTDx. It works as it has the same size and alignment as <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">cufftdx</span><span class="o">::</span><span class="n">complex</span><span class="w"></span></code>.</p>
<p>In the <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">simple_fft_block_cub_io</span><span class="w"></span></code> the NVIDIA CUB library (<a class="reference external" href="https://github.com/NVIDIA/cub">https://github.com/NVIDIA/cub</a>) is used for input/output functions instead
of functions from <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">block_io</span><span class="p">.</span><span class="n">hpp</span><span class="w"></span></code>. It requires CUB in 1.13 version or newer.</p>
</div>
</div>
<div class="section" id="nvrtc-examples">
<h2>NVRTC Examples<a class="headerlink" href="#nvrtc-examples" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">nvrtc_fft_thread</span><span class="w"></span></code></p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">nvrtc_fft_block</span><span class="w"></span></code></p></li>
</ul>
<p>The <a class="reference external" href="https://docs.nvidia.com/cuda/nvrtc/index.html">NVRTC</a> examples present how to use cuFFTDx on thread and block level with NVRTC
runtime compilation. The FFT descriptions created with cuFFTDx operators are defined only in the device code. The header file
<code class="code highlight cpp docutils literal highlight-cpp"><span class="n">cufftdx</span><span class="p">.</span><span class="n">hpp</span><span class="w"></span></code> is also included only in the device code that’s passed to the NVRTC. It works as long as the FFT doesn’t require
extra workspace, see <a class="reference internal" href="api/methods.html#make-workspace-method-label"><span class="std std-ref">Make Workspace Function</span></a> section and
<a class="reference internal" href="api/traits.html#requiresworkspace-block-trait-label"><span class="std std-ref">FFT::requires_workspace</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since version 0.3.0 cuFFTDx has an experimental support for compilation with <a class="reference external" href="https://docs.nvidia.com/cuda/nvrtc/index.html">NVRTC</a>.
See <a class="reference internal" href="requirements_func.html#requirements-and-functionality-label"><span class="std std-ref">Requirements and Functionality</span></a> section.</p>
</div>
</div>
<div class="section" id="fft-performance">
<h2>FFT Performance<a class="headerlink" href="#fft-performance" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">block_fft_performance</span><span class="w"></span></code></p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">block_fft_performance_many</span><span class="w"></span></code></p></li>
</ul>
<p>The examples listed above report the performance of cuFFTDx device functions calculating FFT. Users can easily modify <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">block_fft_performance</span><span class="w"></span></code>
to test the performance of a particular FFT they want to use. <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">block_fft_performance_many</span><span class="w"></span></code> example runs benchmarks for multiple different
single precision FFT problems to show how performance changes depending on the size and the type of an FFT.</p>
</div>
<div class="section" id="convolution-examples">
<h2>Convolution Examples<a class="headerlink" href="#convolution-examples" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">convolution</span><span class="w"></span></code></p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">convolution_r2c_c2r</span><span class="w"></span></code></p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">convolution_performance</span><span class="w"></span></code></p></li>
</ul>
<p>The convolution examples perform a simplified FFT convolution, either with complex-to-complex forward and inverse FFTs (<code class="code highlight cpp docutils literal highlight-cpp"><span class="n">convolution</span><span class="w"></span></code>),
or real-to-complex and complex-to-real FFTs (<code class="code highlight cpp docutils literal highlight-cpp"><span class="n">convolution_r2c_c2r</span><span class="w"></span></code>).</p>
<p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">convolution_performance</span><span class="w"></span></code> examples reports the performance difference between 3 options: single-kernel path using cuFFTDx (forward FFT,
pointwise operation, inverse FFT in a single kernel), 3-kernel path using cuFFT calls and a custom kernel for the pointwise operation,
2-kernel path using cuFFT callback API (requires <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">CUFFTDX_EXAMPLES_CUFFT_CALLBACK</span><span class="w"></span></code> cmake option to be set to
<code class="code highlight cpp docutils literal highlight-cpp"><span class="n">ON</span><span class="w"></span></code>: <code class="code highlight cpp docutils literal highlight-cpp"><span class="o">-</span><span class="n">DCUFFTDX_EXAMPLES_CUFFT_CALLBACK</span><span class="o">=</span><span class="n">ON</span><span class="w"></span></code>). Depending on the device, the precision and the size of a given FFT the improvements
from using cuFFTDx range from 20% to up to 3x speed-ups. The results of <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">convolution_performance</span><span class="w"></span></code> on NVIDIA A100 80GB GPU are presented
in <a class="reference internal" href="#examples-convolution-perf-img"><span class="std std-numref">Fig. 1</span></a>.</p>
<div class="figure align-center" id="id2">
<span id="examples-convolution-perf-img"></span><a class="reference internal image-reference" href="_images/convolution_performance_a100_80gb.svg"><img alt="FFT convolution performance with cuFFT and cuFFTDx on A100 80GB with maximum clocks set." src="_images/convolution_performance_a100_80gb.svg" width="700" /></a>
<p class="caption"><span class="caption-number">Fig. 1 </span><span class="caption-text">Comparison of batched complex-to-complex convolution with pointwise scaling (forward FFT, scaling, inverse FFT) performed with cuFFT,
cuFFT utilizing callback API (requires separate compilation), and cuFFTDx on A100 80GB with maximum clocks set. Chart presents relative
performance compared to cuFFT (light blue).</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="input-output-helper-functions">
<h2>Input/Output Helper Functions<a class="headerlink" href="#input-output-helper-functions" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">block_io</span><span class="p">.</span><span class="n">hpp</span><span class="w"></span></code></p></li>
</ul>
<p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">block_io</span><span class="p">.</span><span class="n">hpp</span><span class="w"></span></code> contains all helper input/output functions that are used in the example kernels. They are implemented according to the
data layout requirements described in <a class="reference internal" href="api/methods.html#execution-methods-input-output-format-label"><span class="std std-ref">Input/Output Data Format</span></a> and
<a class="reference internal" href="api/methods.html#execution-methods-value-format-label"><span class="std std-ref">Value Format</span></a> sections. Included i/o functions are not promised to deliver the best
performance for every FFT configuration. Users may have to write their own to match their needs.</p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="api/methods.html" class="btn btn-neutral float-left" title="Execution Methods" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="release_notes.html" class="btn btn-neutral float-right" title="Release Notes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, NVIDIA Corporation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  

  <style>
  a:link, a:visited {
    color: #76b900;
  }

  a:hover {
    color: #8c0;
  }

  .rst-content dl:not(.docutils) dt {
    background: rgba(118, 185, 0, 0.1);
    color: rgba(59,93,0,1);
    border-top: solid 3px rgba(59,93,0,1);
  }
  </style>
  

</body>
</html>